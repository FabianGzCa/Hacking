import hashlib
import base64

def drupal_hash(password):
    prefix = '$S$'
    count_log2 = 15
    salt = 'abcdefgh'  # Salt de 8 caracteres (puedes cambiarlo)
    count = 1 << count_log2

    # Crear el hash inicial
    hash_str = hashlib.sha512((salt + password).encode('utf-8')).digest()
    
    for _ in range(count):
        hash_str = hashlib.sha512(hash_str + password.encode('utf-8')).digest()

    # Convertir a formato base64
    hashed_password = base64.b64encode(hash_str).decode('utf-8')
    hashed_password = hashed_password.rstrip('=')

    # Formato final del hash
    final_hash = f'{prefix}{salt}{hashed_password}'
    
    return final_hash

# ContraseÃ±a a hashear
password = 'a'

# Generar el hash
hashed_password = drupal_hash(password)

print(hashed_password)
